# main_trigger.sql

> **ВНИМАНИЕ:** Данный код не подлежит копированию или использованию без разрешения автора (Все права защищены).
> Данный код не предназначен для использования или распространения без письменного разрешения автора.

## Назначение

- Создает триггер `main_trigger` (AFTER INSERT ON `notes`).
- Когда в таблицу `notes` вставляется новая строка, триггер:
  1. Считает вспомогательные величины (TimeRead, TimeSend).
  2. Определяет, к какому периоду относится запись (сегодня, 3 дня назад, 1 неделя, 2 недели, 1 месяц, год и т.д.).
  3. Обновляет или вставляет данные в соответствующие таблицы (`Today`, `ThreeDaysAgo`, `OneWeekAgo`, `TwoWeeksAgo`, …).
  4. Также обновляет/добавляет данные в `AllTime`.

## Ключевые моменты

- Используются переменные (`TimeRead`, `TimeSend`) для расчетов.
- Применяются даты и интервалы (например, `CURDATE()`, `WEEKDAY(CURDATE())`, `LAST_DAY(CURDATE())`).
- Для кажого временного интервала проверяется, есть ли уже запись в соответствующей таблице — тогда она обновляется, иначе создается новая.

**Автор: sambuka_lx**

Для связи: https://t.me/Sambuka_lxql
