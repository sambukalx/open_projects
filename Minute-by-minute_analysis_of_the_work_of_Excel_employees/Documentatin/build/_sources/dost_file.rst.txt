.. _dost_file:

dost_file.py
============

Этот модуль содержит функции для работы с файлами, включая перемещение файлов в лог-папку и переименовывание файлов формата `.xlsx`.

Функции
-------

.. function:: fileto_log(files, output_excel_path)

   Перемещает указанные файлы в папку 'log', создавая эту папку, если она не существует. Также переименовывает файлы, если они уже существуют в папке назначения.

   :param list files: Список файлов для перемещения.
   :param str output_excel_path: Путь, где будет проверяться или создаваться папка 'log'.
   :return: Путь до папки 'log'.
   :rtype: str

   Пример использования:

   .. code-block:: python

      files = ["path/to/file1.xlsx", "path/to/file2.xlsx"]
      output_excel_path = "path/to/output"
      log_path = fileto_log(files, output_excel_path)
      print(f"Файлы перемещены в {log_path}")


   Входные параметры:

   - **files**: список путей до файлов, которые необходимо переместить.
   - **output_excel_path**: путь до директории, в которой будет создана (если отсутствует) папка 'log'.

   Описание процесса:

   1. Проверка существования папки 'log' по заданному пути. Если не существует, создается новая.
   2. Для каждого файла из списка проверяется его существование.
   3. Если файл существует в целевой папке, добавляется уникальный суффикс к имени.
   4. Файлы перемещаются в папку 'log', при этом регистрируются соответствующие действия в лог-файле.

frename_xlsx_files
^^^^^^^^^^^^^^^^^^

.. function:: frename_xlsx_files(base_path)

   Переименовывает все файлы `.xlsx` в заданной директории, добавляя к ним имя текущей папки.

   :param str base_path: Базовый путь до директории, в которой следует искать файлы для переименования.

   Пример использования:

   .. code-block:: python

      start_path = 'path/to/directory'
      frename_xlsx_files(start_path)


   Входные параметры:

   - **base_path**: путь до базовой директории, в которой следует производить поиск и переименование файлов.

   Описание процесса:

   1. Проход по всем каталогам и подпапкам в указанной директории.
   2. Для каждого файла с расширением `.xlsx` генерируется новое имя, добавляется имя текущей папки.
   3. Файлы переименовываются с новым именем, и информация об этом выводится на экран.

Примеры использования функций
-----------------------------

Пример вызова функции ``fileto_log``

```python
timefiles = ["path/to/file1.xlsx", "path/to/file2.xlsx"]
patlog = 'path/to/output'
fileto_log(timefiles, patlog)
```

Пример вызова функции ``frename_xlsx_files``

```python
start_path = 'path/to/directory'
frename_xlsx_files(start_path)
```

Логирование
-----------

Модуль использует стандартный модуль `logging` для ведения журнала событий. Это позволяет отслеживать выполнение функций и выявлять возможные ошибки при перемещении и переименовании файлов.

Импортируемые модули
---------------------

- `os`: используется для работы с файловой системой.
- `shutil`: используется для перемещения файлов.
- `logging`: используется для ведения журнала событий.