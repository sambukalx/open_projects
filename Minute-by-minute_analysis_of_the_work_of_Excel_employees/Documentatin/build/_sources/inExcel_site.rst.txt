inExcel_site.py
===============

Этот модуль предоставляет функцию для соответствия сайтов внутри Excel файла и обновления их на основе заданной карты соответствий.

Глобальные Импорты
------------------

- `colorama`: Модуль для раскрашивания текста в консоли.
- `pandas`: Модуль для работы с данными в формате DataFrame и Excel.
- `os`: Модуль для работы с файловой системой.

Функции
-------


.. function:: process_excel(input_file, url_mapping, output_file)

    Функция для соответствия сайтов внутри Excel файла и обновления исходного файла на основе заданной карты соответствий.

    **Аргументы**

    - **input_file** *(str)*: Путь к входному Excel файлу, который нужно обработать.
    - **url_mapping** *(dict)*: Словарь, где ключи - это префиксы URL сайтов, а значения - это замены для этих префиксов.
    - **output_file** *(str)*: Путь к выходному Excel файлу, куда будет сохранен обновленный файл.

    **Описание алгоритма**:

    1. Инициализирует цветной вывод в консоли.
    2. Определяет директорию и имя выходного файла на основе заданного input_file.
    3. Загружает входной Excel файл.
    4. Обрабатывает каждый лист в файле:
       - Проверяет наличие колонки "Сайт".
       - Обновляет значения в колонке "Сайт" на основе карты соответствий.
    5. Сохраняет все обработанные листы в новый Excel файл.
    6. Возвращает путь к созданному (обновленному) Excel файлу с сайтами.

    **Пример кода**:

    .. code-block:: python

        input_file = '/path/to/input/file.xlsx'
        url_mapping = {
            'http://example.com': 'http://new-url.com',
            'http://old-site.com': 'http://updated-site.com'
        }
        output_file = '/path/to/output/file.xlsx'
        process_excel(input_file, url_mapping, output_file)

    **Вывод на консоль**:
    При успешном выполнении функции будет напечатано сообщение о создании обновленного файла и его местоположении. В случае ошибок будут выведены соответствующие сообщения об ошибках.

---